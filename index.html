<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Onyx Wolves | Organisation Criminelle</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <!-- ✅ CDN Supabase plus fiable (UMD build explicite) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <style>
    :root {
      --black: #000000;
      --white: #ffffff;
      --dark: #0a0a0a;
      --gray: #121212;
      --light-gray: #1e1e1e;
      --border: rgba(255,255,255,0.15);
      --electric-blue: #00ffff;
      --electric-glow: #00eaff;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, sans-serif;
    }
    body {
      background-color: var(--dark);
      color: var(--white);
      overflow-x: hidden;
      background-image:
        linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
        url('');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    @media (max-width: 768px) {
      body { background-attachment: scroll; }
    }
    header {
      background: rgba(0, 0, 0, 0.92);
      backdrop-filter: blur(10px);
      padding: 1.2rem 5%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 3000;
      border-bottom: 1px solid var(--border);
    }
    .logo {
      font-size: 2.5rem;
      font-weight: 800;
      letter-spacing: 3px;
      background: linear-gradient(90deg, #fff, #ccc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 12px rgba(255,255,255,0.4);
      cursor: pointer;
    }
    nav a {
      color: var(--white);
      text-decoration: none;
      margin-left: 1.8rem;
      font-weight: 600;
      position: relative;
    }
    nav a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--white);
      transition: width 0.3s ease;
    }
    nav a:hover::after { width: 100%; }
    main { margin-top: 80px; }
    section { padding: 7rem 8%; display: flex; flex-direction: column; align-items: center; }
    h1 {
      font-size: 4.2rem;
      text-align: center;
      margin-bottom: 2.5rem;
      text-transform: uppercase;
      letter-spacing: 4px;
      background: linear-gradient(90deg, #ffffff, #bbbbbb);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(255,255,255,0.3);
      animation: pulseGlow 3s infinite alternate;
    }
    @keyframes pulseGlow { 
      0%{ text-shadow:0 0 15px rgba(255,255,255,0.3);} 
      100%{ text-shadow:0 0 30px rgba(255,255,255,0.6),0 0 40px rgba(255,255,255,0.4); } 
    }
    h2 {
      font-size: 2.4rem;
      margin: 4rem 0 3rem;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 2px;
      position: relative;
      display: inline-block;
      animation: glitch 3s infinite;
    }
    @keyframes glitch { 
      0%{filter:brightness(1)} 
      50%{filter:brightness(1.3) hue-rotate(5deg)} 
      100%{filter:brightness(1)} 
    }
    h2::after {
      content: '';
      position: absolute;
      bottom: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(to right, transparent, #fff, transparent);
    }
    /* Hierarchy styles kept as before */
    .hierarchy-container { position: relative; width: 100%; max-width: 800px; margin: 3rem auto; padding: 4rem 0; height: 500px; display:flex; justify-content:center; align-items:center; }
    .hierarchy-svg { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1; }
    .hierarchy-node {
      position: absolute;
      background: rgba(20,20,20,0.8);
      border: 2px solid var(--electric-blue);
      border-radius: 12px;
      padding: 0.95rem 2.2rem;
      font-size: 1.35rem;
      font-weight: 600;
      color: var(--white);
      box-shadow: 0 0 18px var(--electric-blue), 0 0 8px #fff2;
      transition: all 0.3s ease;
      text-shadow: 0 2px 6px var(--electric-blue);
      cursor: pointer;
      backdrop-filter: blur(5px);
      z-index: 2;
    }
    .hierarchy-node:hover { 
      box-shadow: 0 0 32px var(--electric-blue),0 0 20px #fff5; 
      transform:scale(1.1) rotate(-2deg); 
      background:rgba(0,255,255,0.1); 
      color:var(--electric-blue); 
      border-color:#fff; 
      text-shadow:0 0 10px var(--electric-blue); 
    }
    .leader{ top:10%; left:25% } 
    .co-leader{ top:10%; right:25% } 
    .frere-darme{ top:39%; left:10% } 
    .braqueur{ top:39%; right:10% } 
    .tueur{ bottom:10%; left:25% } 
    .p-dessai{ bottom:10%; right:25% }
    .zentys-logo { 
      position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); 
      z-index:3; font-family:'Brush Script MT',cursive; font-size:2.5rem; font-weight:600; 
      color:var(--white); text-shadow:0 0 34px var(--electric-blue),0 0 12px #fff; 
      letter-spacing:2px; pointer-events:none; user-select:none; 
      animation:electricPulse 2s infinite alternate; 
    }
    @keyframes electricPulse { 
      0%{ text-shadow:0 0 20px var(--electric-blue),0 0 8px #fff } 
      100%{ text-shadow:0 0 40px var(--electric-blue),0 0 16px #fff } 
    }
    .electric-line { 
      stroke:var(--electric-blue); stroke-width:3; 
      stroke-dasharray:14,7,3,4; filter:url(#electric-glow); 
      animation:electric 1.65s linear infinite; 
    }
    @keyframes electric { to{ stroke-dashoffset: -40; } }
    .electric-glow { filter: drop-shadow(0 0 8px var(--electric-blue)) drop-shadow(0 0 4px #fff); }
    .node-glow { animation: nodeGlow 2s infinite alternate; }
    @keyframes nodeGlow { 
      0%{ box-shadow:0 0 15px var(--electric-blue); } 
      100%{ box-shadow:0 0 30px var(--electric-blue),0 0 10px #fff; } 
    }
    /* Layout & grids */
    .grades-grid, .role-column, .immat-full-grid, .vehicles-grid, .tenues-container { width:100%; max-width:1200px; }
    .grades-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:1.8rem; margin-top:2.5rem; }
    .grade-item { background:var(--light-gray); border-radius:10px; padding:.8rem 1.2rem; box-shadow:0 4px 12px rgba(0,0,0,0.5); display:flex; flex-direction:column; gap:.3rem; transition:transform .3s; }
    .grade-item:hover { transform:translateY(-5px); }
    .grade-title { font-size:1.25rem; font-weight:700; color:var(--white); text-transform:uppercase; text-align:center; width:100%; }
    .members-list { display:flex; flex-wrap:wrap; gap:.3rem; justify-content:center; width:100%; }
    .member-item { display:flex; align-items:center; gap:.2rem; font-size:.9rem; color:#aaa; background:rgba(255,255,255,0.1); padding:.2rem .4rem; border-radius:4px; cursor:pointer; }
    .member-item:hover { background:rgba(0,255,255,0.2); color:var(--electric-blue); }
    .immat-badge { display:inline-block; background:var(--white); color:var(--black); font-weight:bold; padding:.1rem .3rem; border-radius:3px; font-size:.8rem; }
    /* role / immat / vehicles / tenues (kept) */
    .roles-section { display:flex; flex-direction:column; gap:2rem; margin-top:2.5rem; }
    .role-column { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:1.8rem; }
    .role-item { background:var(--light-gray); border-radius:10px; padding:.8rem 1.2rem; box-shadow:0 4px 12px rgba(0,0,0,0.5); transition:transform .3s; }
    .role-item:hover { transform:translateY(-5px); }
    .role-title { font-size:1.25rem; font-weight:700; color:var(--white); text-transform:uppercase; }
    .role-details { display:flex; flex-wrap:wrap; gap:.3rem; color:#aaa; }
    /* vehicles */
    .immat-full-section { display:flex; flex-direction:column; gap:2rem; margin-top:2.5rem; }
    .immat-full-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:1.8rem; }
    .immat-full-item { background:var(--light-gray); border-radius:10px; padding:1rem 1.5rem; box-shadow:0 4px 12px rgba(0,0,0,0.5); transition:transform .3s; }
    .immat-full-item:hover { transform:translateY(-5px); }
    .immat-full-header { font-size:1.1rem; font-weight:700; color:var(--white); }
    .vehicles-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:2.2rem; margin-top:2.5rem; }
    .vehicle-card { background:var(--light-gray); border-radius:14px; overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,0.6); transition:transform .4s; }
    .vehicle-card:hover { transform:translateY(-12px); box-shadow:0 12px 30px rgba(0,0,0,0.8),0 0 20px rgba(255,255,255,0.1); }
    .vehicle-card img { width:100%; height:130px; object-fit:cover; border-bottom:2px solid var(--white); }
    .vehicle-card h4 { padding:.9rem .8rem .5rem; font-size:1.15rem; }
    /* tenues */
    .tenues-section { display:flex; flex-direction:column; gap:2rem; margin-top:2.5rem; }
    .tenues-container { display:flex; gap:5rem; width:100%; justify-content:center; }
    .tenue-column { flex:1; display:flex; flex-direction:column; gap:1rem; max-width:300px; }
    .tenue-category { background:var(--light-gray); border-radius:10px; padding:.8rem 1.2rem; box-shadow:0 4px 12px rgba(0,0,0,0.5); transition:transform .3s; }
    .tenue-category:hover { transform:translateY(-5px); }
    .tenue-category-title { font-size:1.1rem; font-weight:700; color:var(--white); text-transform:uppercase; text-align:center; }
    .tenue-item { display:flex; flex-direction:column; gap:.2rem; width:100%; font-size:.9rem; color:#aaa; padding:.3rem 0; border-bottom:1px solid rgba(255,255,255,0.05); }
    .tenue-item:last-child { border-bottom:none; }
    .tenue-info { display:flex; gap:.5rem; align-items:center; }
    .tenue-label { font-weight:600; min-width:70px; }
    .tenue-value { background:rgba(255,255,255,0.1); color:var(--white); padding:.2rem .5rem; border-radius:4px; font-size:.85rem; min-width:30px; text-align:center; }
    .tenue-note { font-style:italic; font-size:.8rem; color:#888; margin-top:.3rem; text-align:center; }
    /* Contact and buttons */
    .contact-section { text-align:center; margin-top:2.5rem; max-width:700px; }
    .discord-btn { 
      background:#5865F2; color:white; border:none; padding:1rem 2.2rem; 
      border-radius:50px; font-weight:600; font-size:1.25rem; cursor:pointer; 
      display:inline-flex; align-items:center; gap:.8rem; margin:1rem 0; transition:all .3s; 
    }
    .discord-btn:hover { 
      background:#4752c4; transform:translateY(-3px); 
      box-shadow:0 6px 20px rgba(88,101,242,0.5); 
    }
    .discord-btn.secondary { background:#00eaff; color:#000; }
    /* footer */
    footer { background: rgba(10,10,10,0.92); text-align:center; padding:2.5rem; margin-top:4rem; border-top:1px solid var(--border); }
    /* Modal base */
    .modal { 
      display:none; position:fixed; z-index:5000; left:0; top:0; 
      width:100%; height:100%; background-color:rgba(0,0,0,0.92); 
      backdrop-filter:blur(8px); justify-content:center; align-items:center; 
    }
    .modal-content { 
      background:var(--gray); border:2px solid var(--electric-blue); 
      border-radius:16px; padding:2rem; width:90%; max-width:500px; 
      box-shadow:0 0 30px var(--electric-blue); position:relative; 
      animation:modalPop .4s cubic-bezier(.175,.885,.32,1.275); 
    }
    @keyframes modalPop { 
      0%{ transform:scale(.8); opacity:0 } 
      100%{ transform:scale(1); opacity:1 } 
    }
    .close-btn { 
      position:absolute; top:15px; right:20px; font-size:1.8rem; 
      color:#fff; cursor:pointer; transition: color .3s, transform .2s; 
    }
    .close-btn:hover { color:var(--electric-blue); transform:rotate(90deg); }

    /* ===== QUOTA MODAL — BASE ===== */
    .quota-modal { 
      display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
      background:rgba(0,0,0,0.9); backdrop-filter:blur(8px); z-index:9999; 
      justify-content:center; align-items:center; 
    }
    .quota-modal-content {
      background: var(--gray);
      border: 2px solid var(--electric-blue);
      border-radius: 16px;
      width: 90%;
      max-width: 700px;
      padding: 2rem;
      box-shadow: 0 0 30px var(--electric-blue);
      position: relative;
      /* ✅ ANIMATION FLUIDE AVEC max-height */
      transition: max-height 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
                  border-color 0.4s ease,
                  box-shadow 0.4s ease;
      overflow: hidden;
      /* Hauteur initiale suffisante pour "Rajout" (plus grand) */
      max-height: 600px; /* valeur suffisante pour Rajout */
      min-height: 600px;
    }

    /* ===== Thèmes dynamiques ===== */
    .quota-modal-content.rajout-theme {
      max-height: 600px;
      border-color: #ff3333;
      box-shadow: 0 0 30px rgba(255, 51, 51, 0.7);
    }
    .quota-modal-content.rajout-theme h3 {
      color: #ff3333 !important;
    }

    .quota-modal-content.dossier-theme {
      max-height: 420px;
      min-height: 420px;
      border-color: #9933ff;
      box-shadow: 0 0 30px rgba(153, 51, 255, 0.7);
    }
    .quota-modal-content.dossier-theme h3 {
      color: #b366ff !important;
    }

    /* ===== Onglets — Design unifié noir + néon ===== */
    .quota-tabs {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .quota-tab-btn {
      padding: 0.6rem 1.2rem;
      background: #000;
      color: white;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    /* Rajout = tout en rouge */
    .quota-modal-content.rajout-theme .quota-tab-btn {
      border: 2px solid #ff3333;
      box-shadow: 0 0 8px rgba(255, 51, 51, 0.4);
    }
    .quota-modal-content.rajout-theme .quota-tab-btn:hover {
      box-shadow: 0 0 16px rgba(255, 51, 51, 0.7);
      transform: translateY(-2px);
    }
    .quota-modal-content.rajout-theme .quota-tab-btn.active {
      background: #111;
      border-color: #ff0000;
      box-shadow: 0 0 12px rgba(255, 0, 0, 0.6);
    }

    /* Dossier = tout en violet */
    .quota-modal-content.dossier-theme .quota-tab-btn {
      border: 2px solid #9933ff;
      box-shadow: 0 0 8px rgba(153, 51, 255, 0.4);
    }
    .quota-modal-content.dossier-theme .quota-tab-btn:hover {
      box-shadow: 0 0 16px rgba(153, 51, 255, 0.7);
      transform: translateY(-2px);
    }
    .quota-modal-content.dossier-theme .quota-tab-btn.active {
      background: #111;
      border-color: #8000ff;
      box-shadow: 0 0 12px rgba(128, 0, 255, 0.6);
    }

    .quota-tab-content { display: none; }
    .quota-tab-content.active { display: block; }

    /* ===== Formulaire & Boutons universels ===== */
    .quota-form label {
      display: block;
      margin: 0.8rem 0 0.4rem;
      font-weight: 600;
      color: #cfeff0;
    }
    .quota-form input,
    .quota-form select,
    .quota-form textarea {
      width: 100%;
      padding: 0.7rem;
      background: var(--light-gray);
      border: 1px solid var(--border);
      color: white;
      border-radius: 8px;
    }

    /* ✅ Bouton "Envoyer le quota" dynamique */
    .quota-modal-content.rajout-theme .quota-form button[type="submit"] {
      background: #000;
      color: white;
      border: 2px solid #ff3333;
      box-shadow: 0 0 8px rgba(255, 51, 51, 0.4);
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .quota-modal-content.rajout-theme .quota-form button[type="submit"]:hover {
      box-shadow: 0 0 16px rgba(255, 51, 51, 0.7);
      transform: translateY(-2px);
    }

    .quota-modal-content.dossier-theme .quota-form button[type="submit"] {
      background: #000;
      color: white;
      border: 2px solid #9933ff;
      box-shadow: 0 0 8px rgba(153, 51, 255, 0.4);
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .quota-modal-content.dossier-theme .quota-form button[type="submit"]:hover {
      box-shadow: 0 0 16px rgba(153, 51, 255, 0.7);
      transform: translateY(-2px);
    }

    /* Catégories (Drogue, Go-Fast...) */
    .quota-cat-btn {
      background: #000;
      color: white;
      border: 2px solid var(--electric-blue);
      border-radius: 8px;
      padding: 10px 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    /* Catégorie sélectionnée — Rajout */
    .quota-modal-content.rajout-theme .quota-cat-btn.active {
      background: #111;
      color: white;
      border-color: #ff0000;
      box-shadow: 0 0 12px rgba(255, 0, 0, 0.6);
    }

    /* Catégorie sélectionnée — Dossier */
    .quota-modal-content.dossier-theme .quota-cat-btn.active {
      background: #111;
      color: white;
      border-color: #8000ff;
      box-shadow: 0 0 12px rgba(128, 0, 255, 0.6);
    }

    /* Hover des catégories */
    .quota-modal-content.rajout-theme .quota-cat-btn:hover:not(.active) {
      box-shadow: 0 0 8px rgba(255, 51, 51, 0.4);
    }
    .quota-modal-content.dossier-theme .quota-cat-btn:hover:not(.active) {
      box-shadow: 0 0 8px rgba(153, 51, 255, 0.4);
    }

    .quota-modal h3 {
      text-align: center;
      margin-bottom: 1.5rem;
      color: var(--electric-blue);
      font-size: 1.8rem;
    }
    .close-quota {
      position: absolute;
      top: 1rem;
      right: 1.2rem;
      font-size: 1.8rem;
      color: #fff;
      cursor: pointer;
    }

    /* ===== Dossier inline login ===== */
    .dossier-login {
      display: flex;
      justify-content: center;
      padding: 6px 0 0 0;
    }
    .dossier-login-grid {
      width: 100%;
      max-width: 620px;
      background: rgba(0,0,0,0.18);
      padding: 14px;
      border-radius: 10px;
      border: 1px solid rgba(0,255,255,0.06);
      box-shadow: 0 8px 40px rgba(0,170,200,0.04);
      display: block;
    }
    .dossier-login .field {
      margin-bottom: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .dossier-login .field label {
      display: block;
      font-weight: 700;
      color: #cfeff0;
      margin-bottom: 6px;
      font-size: 0.95rem;
      text-align: center;
    }
    .dossier-login .field input {
      width: 68%;
      max-width: 420px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.06);
      background: #0f0f10;
      color: #fff;
      outline: none;
      transition: box-shadow 160ms ease, border-color 160ms ease;
      display: block;
      margin: 0 auto;
    }
    .dossier-login .field input:focus {
      border-color: #00eaff;
      box-shadow: 0 6px 18px rgba(0,234,255,0.06);
    }
    .login-row, .login-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 6px;
    }
    .dossier-login .login-btn, .dossier-login .cancel-btn {
      padding: 8px 12px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      border: none;
      min-height: 36px;
    }
    .dossier-login .login-btn {
      background: #00eaff;
      color: #000;
      border: 1px solid rgba(0,255,255,0.9);
    }
    .dossier-login .cancel-btn {
      background: transparent;
      color: #fff;
      border: 1px solid rgba(255,255,255,0.06);
    }
    .dossier-login-error {
      margin-top: 8px;
      color: #ff9999;
      font-size: 0.92rem;
      display: block;
      min-height: 1.2em;
    }

    /* ===== Liste des quotas ===== */
    .quota-list { 
      max-height: 360px; overflow: auto; padding: 8px; 
      display: flex; flex-direction: column; gap: 10px; 
    }
    .quota-entry { 
      padding: 12px; background: rgba(255,255,255,0.03); 
      border-left: 3px solid var(--electric-blue); border-radius: 8px; 
      color: #e9eef0; 
    }
    .quota-entry small { 
      color: #bfc7c7; display: block; margin-top: 8px; 
    }
    .quota-list::-webkit-scrollbar { width: 12px; }
    .quota-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); border-radius: 8px; }
    .quota-list::-webkit-scrollbar-thumb { background: rgba(0,255,255,0.12); border-radius: 8px; }
    .quota-entry strong { color: var(--electric-blue); }

    /* ===== Responsive ===== */
    @media (max-width: 600px) {
      .dossier-login .field input { width: 90%; max-width: none; }
      .dossier-login .field label { text-align: left; width: 90%; }
      .dossier-login-grid { padding: 12px; }
    }
    @media (max-width: 768px) {
      h1 { font-size: 2.8rem !important; padding: 0 1rem; }
      h2 { font-size: 1.8rem !important; }
      .logo { font-size: 2rem !important; }
      nav a { margin-left: 1rem; font-size: 0.95rem; }
      section { padding: 5rem 5% !important; }
      .hierarchy-container { height: auto !important; padding: 2rem 0 !important; }
      .hierarchy-node { font-size: 0.9rem !important; padding: 0.6rem !important; min-width: 100px; }
      .zentys-logo { font-size: 1.8rem !important; }
      .grades-grid, .role-column, .immat-full-grid, .vehicles-grid { grid-template-columns: 1fr !important; gap: 1.2rem !important; }
      .tenues-container { flex-direction: column !important; align-items: center !important; gap: 2rem !important; }
      .tenue-column { max-width: 100% !important; padding: 0 1rem; }
      .vehicle-card img { height: 100px !important; }
      .vehicle-card h4 { font-size: 1rem !important; }
      footer { padding: 1.5rem !important; font-size: 0.9rem; }
      .quota-modal-content { padding: 12px; }
      .dossier-login-grid { max-width: 100%; padding: 12px; }
    }
    @media (max-width: 480px) {
      h1 { font-size: 2.3rem !important; }
      h2 { font-size: 1.6rem !important; }
      .logo { font-size: 1.8rem !important; }
      nav { display: flex; flex-wrap: wrap; justify-content: center; }
      nav a { margin: 0.3rem 0.6rem; }
    }
    [aria-hidden="true"] { pointer-events: none; }
  </style>
</head>
<body>
  <header>
    <div class="logo" id="logo-top">Onyx Wolves</div>
    <nav>
      <a href="#hierarchy">Hiérarchie</a>
      <a href="#grades">Grades</a>
      <a href="#roles">Rôles</a>
      <a href="#immatricules">Immatricules</a>
      <a href="#vehicles">Véhicules</a>
      <a href="#tenues">Tenues</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>
  <main>
    <section>
      <h1>Onyx Wolves</h1>
      <p style="text-align:center; max-width:850px; margin:0 auto; color:#ddd; font-size:1.25rem; line-height:1.8;">
        Discipline. Loyauté. Immatriculés. Une seule loi : la nôtre.
      </p>
    </section>
    <!-- HIÉRARCHIE -->
    <section id="hierarchy">
      <h2>HIÉRARCHIE</h2>
      <div class="hierarchy-container">
        <svg class="hierarchy-svg" viewBox="0 0 500 500" preserveAspectRatio="xMidYMid meet" width="100%" height="100%">
          <defs>
            <filter id="electric-glow">
              <feGaussianBlur in="SourceAlpha" stdDeviation="3" result="blur"/>
              <feSpecularLighting in="blur" surfaceScale="5" specularConstant="0.75" specularExponent="20" lighting-color="#00ffff" result="specOut">
                <fePointLight x="250" y="250" z="200"/>
              </feSpecularLighting>
              <feComposite in="specOut" in2="SourceAlpha" operator="in" result="specOut"/>
              <feComposite in="SourceGraphic" in2="specOut" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="litPaint"/>
            </filter>
          </defs>
          <line x1="125" y1="70" x2="375" y2="70" class="electric-line" />
          <line x1="125" y1="70" x2="75" y2="195" class="electric-line" />
          <line x1="375" y1="70" x2="425" y2="195" class="electric-line" />
          <line x1="75" y1="195" x2="125" y2="420" class="electric-line" />
          <line x1="425" y1="195" x2="375" y2="420" class="electric-line" />
          <line x1="125" y1="420" x2="375" y2="420" class="electric-line" />
        </svg>
        <div class="hierarchy-node leader node-glow">Leader</div>
        <div class="hierarchy-node co-leader node-glow">Co-Leader</div>
        <div class="hierarchy-node frere-darme node-glow">Frère D'arme</div>
        <div class="hierarchy-node braqueur node-glow">Braqueur</div>
        <div class="hierarchy-node tueur node-glow">Tueur</div>
        <div class="hierarchy-node p-dessai node-glow">P. D'essaie</div>
        <div class="zentys-logo">Onyx Wolves</div>
      </div>
    </section>
    <!-- GRADES -->
    <section id="grades">
      <h2>GRADES</h2>
      <div class="grades-grid">
        <div class="grade-item">
          <div class="grade-title">LEADER</div>
          <div class="members-list">
            <div class="member-item"><span class="immat-badge">02</span> Lily Kashi</div>
            <div class="member-item"><span class="immat-badge">16</span> Mathieu Driven</div>
          </div>
        </div>
        <div class="grade-item">
          <div class="grade-title">CO-LEAD</div>
          <div class="members-list">
            <div class="member-item">
              <span class="immat-badge">16</span> Mathieu Driven
            </div>
          </div>
        </div>
        <div class="grade-item">
          <div class="grade-title">FRÈRE D'ARME</div>
          <div class="members-list">
            <div class="member-item"><span class="immat-badge">03</span> Ziko Kashi</div>
          </div>
        </div>
        <div class="grade-item">
          <div class="grade-title">BRAQUEUR</div>
          <div class="members-list">
            <div class="member-item"><span class="immat-badge"></span></div>
          </div>
        </div>
        <div class="grade-item">
          <div class="grade-title">TUEUR</div>
          <div class="members-list">
            <div class="member-item"><span class="immat-badge"></span></div>
          </div>
        </div>
      </div>
    </section>
    <!-- RÔLES -->
    <section id="roles">
      <h2>RÔLES</h2>
      <div class="roles-section">
        <div class="role-column">
          <div class="role-item">
            <div class="role-title">Conducteur</div>
            <div class="role-details">
              <span class="immat-badge">16</span> Mathieu Driven<br>
              <span class="immat-badge">03</span> Ziko Kashi
            </div>
          </div>
          <div class="role-item">
            <div class="role-title">Braquage</div>
            <div class="role-details">
              <span class="immat-badge">16</span> Mathieu Driven
            </div>
          </div>
          <div class="role-item">
            <div class="role-title">Otage</div>
            <div class="role-details">
              <span class="immat-badge">02</span> Lily Kashi<br>
            </div>
          </div>
          <div class="role-item">
            <div class="role-title">Gérant Illégal</div>
            <div class="role-details">
              <span class="immat-badge">16</span> Mathieu Driven<br>
            </div>
          </div>
          <div class="role-item">
            <div class="role-title">Gérant Support</div>
            <div class="role-details">
              <span class="immat-badge">02</span> Lily Kashi<br>
            </div>
          </div>
          <div class="role-item">
            <div class="role-title">Gérant OP</div>
            <div class="role-details">
              <span class="immat-badge">02</span> Lily Kashi<br>
              <span class="immat-badge">16</span> Mathieu Driven
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- IMMATRICULES -->
    <section id="immatricules">
      <h2>IMMATRICULES COMPLETS (01-29)</h2>
      <div class="immat-full-section">
        <div class="immat-full-grid">
          <div class="immat-full-item">
            <div class="immat-full-header">16 — Mathieu Driven</div>
          </div>
          <div class="immat-full-item">
            <div class="immat-full-header">02 — Lily Kashi</div>
          </div>
          <div class="immat-full-item">
            <div class="immat-full-header">03 — Ziko Kashi</div>
          </div>
        </div>
      </div>
    </section>
    <!-- VÉHICULES -->
    <section id="vehicles">
      <h2>VÉHICULES</h2>
      <div class="vehicles-grid">
        <div class="vehicle-card">
          <img src="https://github.com/loucs1546/Concess/blob/38bb4c703c5afc8edcbebdd4b4bd3e4fe13d95ee/Honda%20Civic%20Type%20R%202020.png?raw=true" alt="Honda">
          <h4>Honda Civic Type R 2020</h4>
          <p>Accéleration basse, Très bon grip, Très fine, 4 places</p>
        </div>
        <div class="vehicle-card">
          <img src="https://github.com/loucs1546/Concess/blob/38bb4c703c5afc8edcbebdd4b4bd3e4fe13d95ee/BMW%20M3%20E92.png?raw=true" alt="Brickade 6x6">
          <h4>Bmw M3 E92</h4>
          <p>Très rapide, Très bonne accéleration, Grip moyen, 2 places</p>
        </div>
        <div class="vehicle-card">
          <img src="https://github.com/loucs1546/Concess/blob/main/Porsche%20911%20GT3%20RS%202016.png?raw=true" alt="Buzzard">
          <h4>Porsche 911 Gt3 RS</h4>
          <p>Appui aérien</p>
        </div>
        <div class="vehicle-card">
          <img src="https://github.com/loucs1546/Concess/blob/main/IbWEBV.jpg?raw=true" alt="Oppressor Mk II">
          <h4>Bmw M5 cs 2019</h4>
          <p>Accéleration basse, Vitesse basse, Très bon grip, 4 places</p>
        </div>
        <div class="vehicle-card">
          <img src="https://github.com/loucs1546/Concess/blob/38bb4c703c5afc8edcbebdd4b4bd3e4fe13d95ee/Land%20Rover%20Velar.png?raw=true" alt="Longfin">
          <h4>Land Rover Velar</h4>
          <p>Bonne accéleration, Bon grip, 4 places,</p>
        </div>
      </div>
    </section>
    <!-- TENUES -->
    <section id="tenues">
      <h2>TENUES</h2>
      <div class="tenues-container">
        <div class="tenue-column">
          <h3 style="text-align: center; margin-bottom: 1rem; font-size: 1.5rem; color: var(--white);">Tenue Homme</h3>
          <div class="tenue-category">
            <div class="tenue-category-title">Masque</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">174</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Écharpe et chaînes</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">1</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Vestes</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">81</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">T-Shirt</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">15</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Body armor</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">28</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">8</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Sacs et parachute</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">121</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Haut du Corps</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">5</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Bas du Corps</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">55</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Chaussures</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">8</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Chapeaux et casques</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">273</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">10</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Lunettes</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">25</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">4</span>
              </div>
            </div>
            <div class="tenue-note">Personalisable selon vos goûts (il est obligatoire de rester dans le même thème)</div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Accessoires d'oreille</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">-1</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Montres</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">30</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
            <div class="tenue-note">Personalisable selon vos goûts (il est obligatoire de rester dans le même thème)</div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Bracelets</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">0</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
            <div class="tenue-note">Personalisable selon vos goûts (il est obligatoire de rester dans le même thème)</div>
          </div>
        </div>
        <div class="tenue-column">
          <h3 style="text-align: center; margin-bottom: 1rem; font-size: 1.5rem; color: var(--white);">Tenue Femme</h3>
          <div class="tenue-category">
            <div class="tenue-category-title">Masque</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">169</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Écharpe et chaînes</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">2</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Vestes</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">338</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">1</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">T-Shirt</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">207</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Body armor</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">0</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Sacs et parachute</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">84</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Haut du Corps</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">59</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Bas du Corps</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">149</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">1</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Chaussures</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">27</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Chapeaux et casques</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">-1</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">-1</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Lunettes</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">6</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
            <div class="tenue-note">Personalisable selon vos goûts (il est obligatoire de rester dans le même thème)</div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Accessoires d'oreille</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">-1</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">-1</span>
              </div>
            </div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Montres</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">4</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">1</span>
              </div>
            </div>
            <div class="tenue-note">Personalisable selon vos goûts (il est obligatoire de rester dans le même thème)</div>
          </div>
          <div class="tenue-category">
            <div class="tenue-category-title">Bracelets</div>
            <div class="tenue-item">
              <div class="tenue-info">
                <span class="tenue-label">Numéro :</span>
                <span class="tenue-value">16</span>
              </div>
              <div class="tenue-info">
                <span class="tenue-label">Variante :</span>
                <span class="tenue-value">0</span>
              </div>
            </div>
            <div class="tenue-note">Personalisable selon vos goûts (il est obligatoire de rester dans le même thème)</div>
          </div>
        </div>
      </div>
    </section>
    <!-- CONTACT -->
    <section id="contact">
      <h2>CONTACT</h2>
      <div class="contact-section">
        <p><i class="fas fa-crown"></i> <strong>Onyx Wolves</strong> – Noir & Blanc</p>
        <a href="https://discord.gg/votre-lien" target="_blank" class="discord-btn">
          <i class="fab fa-discord"></i> Rejoindre le Discord
        </a>
        <p>
          <button id="secret-btn" class="discord-btn" style="background:#00eaff; color:#000; margin-top: 0.4rem;">
            <i class="fas fa-upload"></i> Envoyer Un Quota
          </button>
        </p>
      </div>
      <!-- MODAL QUOTA -->
      <!-- MODAL QUOTA (VERSION SIMPLIFIÉE : RAJOUT SEULEMENT + IMAGE + WEBHOOK) -->
      <div id="quota-modal" class="quota-modal" aria-hidden="true">
        <div id="tab-rajout" class="quota-tab-content">
          <form id="quota-form" style="max-width:480px; margin:0 auto; padding:0 12px;">
            <label for="quota-categorie" style="display:block; margin-bottom:6px; font-weight:600; color:#cfeff0;">Catégorie</label>
            <div class="quota-category-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:14px;">
              <button type="button" class="quota-cat-btn" data-value="Drogue">Drogue</button>
              <button type="button" class="quota-cat-btn" data-value="Go-Fast">Go-Fast</button>
              <button type="button" class="quota-cat-btn" data-value="Donneur">Donneur</button>
              <button type="button" class="quota-cat-btn" data-value="Autre">Autre</button>
            </div>
            <input type="hidden" id="quota-categorie" required>

            <label for="quota-nom" style="display:block; margin:12px 0 6px; font-weight:600; color:#cfeff0;">Nom</label>
            <input type="text" id="quota-nom" placeholder="Ex: Jean Dupont" required
              style="width:100%; padding:9px 12px; background:var(--light-gray); color:#fff; border:1px solid var(--border); border-radius:8px; font-size:0.95rem;">

            <label for="quota-valeur" style="display:block; margin:12px 0 6px; font-weight:600; color:#cfeff0;">Quota (en €)</label>
            <input type="number" id="quota-valeur" placeholder="Ex: 500000" min="0" required
              style="width:100%; padding:9px 12px; background:var(--light-gray); color:#fff; border:1px solid var(--border); border-radius:8px; font-size:0.95rem;">

            <!-- ✅ CHAMP UPLOAD D'IMAGE -->
            <label for="quota-image-upload" style="display:block; margin:18px 0 8px; font-weight:600; color:#cfeff0;">Preuve (screenshot)</label>
            <input type="file" id="quota-image-upload" accept="image/png, image/jpeg, image/webp"
              style="width:100%; padding:6px; background:var(--light-gray); color:#fff; border:1px solid var(--border); border-radius:8px;">

            <div id="image-preview" style="display:none; margin-top:10px; text-align:center;">
              <img id="preview-img" src="" alt="Aperçu" style="max-width:100%; max-height:200px; border-radius:8px; border:1px solid var(--border);">
            </div>

            <button type="submit" style="margin-top:20px; width:100%; padding:10px; background:#000; color:white; font-weight:bold; border:2px solid #ff3333; border-radius:8px; cursor:pointer; font-size:1rem; box-shadow: 0 0 8px rgba(255,51,51,0.4);">
              Envoyer le rajout
            </button>
          </form>
        </div>
      </div>
    </section>
  </main>
  <footer>
    <p>&copy; 2025 Onyx Wolves • Organisation GTA RP • Tous droits réservés</p>
  </footer>

  <!-- ✅ SCRIPT PRINCIPAL CORRIGÉ -->
  <script>
    // Full JavaScript (complete) — Supabase init, quota modal with Rajout default and inline Dossier login,
    // Rajout works without login, Dossier shows inline login inside modal (or global login modal fallback).
    document.addEventListener('DOMContentLoaded', function () {
      // === CONFIG SUPABASE ===
      let supabase = null;
      const supabaseUrl = 'https://modawwgnddvqtqpcbhjt.supabase.co';
      const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1vZGF3d2duZGR2cXRxcGNiaGp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEyMDYzMzEsImV4cCI6MjA3Njc4MjMzMX0.PXxrO_qeSosMVsvupmpAtZZhdGxihmg2STMMgOjkR6Q';

      function initSupabase() {
        const createClientFn =
          (window.Supabase && window.Supabase.createClient) ||
          (window.supabase && window.supabase.createClient) ||
          (window.createClient) ||
          null;
        if (!createClientFn) return null;
        try {
          return createClientFn(supabaseUrl, supabaseAnonKey);
        } catch (err) {
          console.error("Erreur durant l'initialisation Supabase :", err);
          return null;
        }
      }
      supabase = initSupabase();

      // quick test (non blocking)
      (async function testSupabaseConnection() {
        if (!supabase) return;
        try {
          const { error } = await supabase.from('Quota').select('id').limit(1);
          if (error) console.error('Test Supabase select Quota error:', error);
        } catch (e) {
          console.error('Erreur test Supabase:', e);
        }
      })();

      // === STATE & ELEMENTS ===
      let currentUser = null; // { id, user }
      const quotaModal = document.getElementById('quota-modal');
      const secretBtn = document.getElementById('secret-btn');
      const closeQuota = document.querySelector('.close-quota');
      const quotaForm = document.getElementById('quota-form');
      const quotaListContainer = document.getElementById('quota-list-container');

      // inline dossier login elements (may or may not exist depending on HTML)
      const dossierLogin = document.getElementById('dossier-login');
      const dossierLoginUser = document.getElementById('dossier-login-user');
      const dossierLoginPass = document.getElementById('dossier-login-pass');
      const dossierLoginSubmit = document.getElementById('dossier-login-submit');
      const dossierLoginCancel = document.getElementById('dossier-login-cancel');
      const dossierLoginError = document.getElementById('dossier-login-error');0
      const dossierListWrapper = document.getElementById('dossier-list');

      // global login modal will be injected only if inline dossier login is not present
      function injectGlobalLoginIfNeeded() {
        if (document.getElementById('dossier-login')) return; // inline present -> no global needed
        if (document.getElementById('login-modal')) return; // already injected
        const html = `
          <div id="login-modal" aria-hidden="true" style="display:none; position:fixed; inset:0; z-index:12000; justify-content:center; align-items:center; background:rgba(0,0,0,0.6);">
            <div class="login-card" role="dialog" aria-modal="true" style="width:340px; background:#0f0f10; border:2px solid rgba(0,255,255,0.95); padding:20px; border-radius:12px; color:#fff; position:relative;">
              <div class="close-x" id="login-close" title="Fermer" style="position:absolute; right:10px; top:8px; cursor:pointer; font-size:18px; color:#fff;">&times;</div>
              <h3 style="text-align:center; color:#00ffff; margin-bottom:12px;">Connexion — Dossier</h3>
              <label for="login-user" style="display:block; margin-top:8px; color:#cfcfcf; font-weight:600;">Utilisateur</label>
              <input id="login-user" type="text" placeholder="Votre pseudo" autocomplete="username" style="width:100%; padding:10px; margin-top:6px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:#151515; color:#fff;" />
              <label for="login-pass" style="display:block; margin-top:8px; color:#cfcfcf; font-weight:600;">Mot de passe</label>
              <input id="login-pass" type="password" placeholder="Mot de passe" autocomplete="current-password" style="width:100%; padding:10px; margin-top:6px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:#151515; color:#fff;" />
              <div class="login-actions" style="display:flex; gap:10px; margin-top:12px; justify-content:space-between; align-items:center;">
                <button class="cancel-btn" id="login-cancel" style="background:transparent; color:#fff; border:1px solid rgba(255,255,255,0.08); padding:8px 12px; border-radius:8px; cursor:pointer;">Annuler</button>
                <button class="login-btn" id="login-submit" style="background:#00ffff; color:#000; border:none; padding:9px 14px; border-radius:8px; font-weight:700; cursor:pointer;">Se connecter</button>
              </div>
              <div class="login-error" id="login-error" style="color:#ff9999; margin-top:8px; font-size:0.9rem; display:none;"></div>
            </div>
          </div>
        `;
        const wrapper = document.createElement('div');
        wrapper.innerHTML = html;
        document.body.appendChild(wrapper.firstElementChild);
        // attach handlers
        document.getElementById('login-close').addEventListener('click', () => {
          const modal = document.getElementById('login-modal'); if (modal) modal.style.display = 'none';
        });
        document.getElementById('login-cancel').addEventListener('click', () => {
          const modal = document.getElementById('login-modal'); if (modal) modal.style.display = 'none';
        });
        document.getElementById('login-submit').addEventListener('click', async (e) => {
          e.preventDefault();
          await handleGlobalLoginSubmit();
        });
        document.getElementById('login-pass').addEventListener('keydown', function(ev){
          if (ev.key === 'Enter') handleGlobalLoginSubmit();
        });
      }

      // If inline not present, ensure global is available for fallback
      injectGlobalLoginIfNeeded();

      // === UI helpers (toasts / error) ===
      function showToast(message, opts = {}) {
        const containerId = 'app-toasts';
        let container = document.getElementById(containerId);
        if (!container) {
          container = document.createElement('div');
          container.id = containerId;
          container.style.position = 'fixed';
          container.style.right = '18px';
          container.style.bottom = '18px';
          container.style.zIndex = '12000';
          container.style.display = 'flex';
          container.style.flexDirection = 'column';
          container.style.gap = '10px';
          document.body.appendChild(container);
        }
        const toast = document.createElement('div');
        toast.style.pointerEvents = 'auto';
        toast.style.minWidth = '180px';
        toast.style.maxWidth = '360px';
        toast.style.background = 'linear-gradient(180deg, rgba(18,18,18,0.98), rgba(12,12,12,0.98))';
        toast.style.color = '#eaffff';
        toast.style.padding = '10px 12px';
        toast.style.borderRadius = '10px';
        toast.style.borderLeft = opts.type === 'success' ? '4px solid #00ffde' : '4px solid #66d6ff';
        toast.style.fontWeight = '700';
        toast.style.boxShadow = '0 8px 30px rgba(0,170,200,0.06)';
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(6px)';
        toast.textContent = message;
        container.appendChild(toast);
        requestAnimationFrame(() => {
          toast.style.transition = '240ms';
          toast.style.opacity = '1';
          toast.style.transform = 'translateY(0)';
        });
        setTimeout(() => {
          toast.style.opacity = '0';
          toast.style.transform = 'translateY(6px)';
          setTimeout(() => { try { container.removeChild(toast); } catch (e) {} }, 260);
        }, opts.duration || 3000);
      }

      function showErrorModal(title, message) {
        // simple: toast + console
        showToast(`${title}: ${message}`, { type: 'info', duration: 4500 });
        console.error(title, message);
      }

      // === AUTH: global handler (if global login modal is used) ===
      async function authenticateUser(username, password) {
        if (!supabase) return { ok:false, message:'Supabase non initialisé' };
        try {
          const cleaned = String(username || '').trim();
          const res = await supabase
            .from('Compte')
            .select('id, user, password')
            .ilike('user', cleaned)
            .limit(1)
            .maybeSingle();
          if (res && res.error) return { ok:false, message: res.error.message || 'Erreur lecture Compte' };
          if (!res || !res.data) return { ok:false, message:'Utilisateur introuvable' };
          const row = res.data;
          if (String(row.password) === String(password)) return { ok:true, user:{ id: row.id, user: row.user } };
          return { ok:false, message:'Mot de passe invalide' };
        } catch (err) {
          console.error('authenticateUser exception:', err);
          return { ok:false, message: err.message || 'Erreur réseau' };
        }
      }

      async function handleGlobalLoginSubmit() {
        const userInput = document.getElementById('login-user');
        const passInput = document.getElementById('login-pass');
        const errEl = document.getElementById('login-error');
        if (!userInput || !passInput || !errEl) return;
        const username = userInput.value.trim();
        const password = passInput.value;
        if (!username || !password) {
          errEl.textContent = 'Merci de renseigner utilisateur et mot de passe.';
          errEl.style.display = 'block';
          return;
        }
        errEl.style.display = 'none';
        const btn = document.getElementById('login-submit');
        btn.disabled = true;
        btn.textContent = 'Connexion...';
        const res = await authenticateUser(username, password);
        btn.disabled = false;
        btn.textContent = 'Se connecter';
        if (!res.ok) {
          errEl.textContent = res.message || 'Erreur d\'authentification';
          errEl.style.display = 'block';
          return;
        }
        currentUser = res.user;
        // hide global modal
        const modal = document.getElementById('login-modal'); if (modal) modal.style.display = 'none';
        showToast(`Connecté · ${currentUser.user}`, { type: 'success', duration: 2200 });
        // show dossier content in quota modal if present
        if (quotaModal) quotaModal.style.display = 'flex';
        // activate dossier tab and load data
        document.querySelectorAll('.quota-tab-btn').forEach(b => b.classList.remove('active'));
        const dossierBtn = document.querySelector('.quota-tab-btn[data-tab="dossier"]');
        if (dossierBtn) dossierBtn.classList.add('active');
        document.querySelectorAll('.quota-tab-content').forEach(c => c.classList.remove('active'));
        document.getElementById('tab-dossier')?.classList.add('active');
        await loadQuotaData();
      }
      // Gestion des boutons de catégorie
      document.querySelectorAll('.quota-cat-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          // Désactiver tous
          document.querySelectorAll('.quota-cat-btn').forEach(b => b.classList.remove('active'));
          // Activer celui cliqué
          btn.classList.add('active');
          // Mettre à jour le champ caché
          const hiddenInput = document.getElementById('quota-categorie');
          if (hiddenInput) hiddenInput.value = btn.dataset.value;
        });
      });

      // === INLINE AUTH (if dossier-login exists inside modal) ===
      async function authenticateInline(username, password) {
        if (!supabase) return { ok:false, message:'Supabase non initialisé' };
        try {
          const cleaned = String(username || '').trim();
          const res = await supabase
            .from('Compte')
            .select('id, user, password')
            .ilike('user', cleaned)
            .limit(1)
            .maybeSingle();
          if (res && res.error) return { ok:false, message: res.error.message || 'Erreur lecture Compte' };
          if (!res || !res.data) return { ok:false, message:'Utilisateur introuvable' };
          const row = res.data;
          if (String(row.password) === String(password)) return { ok:true, user:{ id: row.id, user: row.user } };
          return { ok:false, message:'Mot de passe invalide' };
        } catch (err) {
          console.error('authenticateInline exception:', err);
          return { ok:false, message: err.message || 'Erreur réseau' };
        }
      }

      if (dossierLoginSubmit) {
        dossierLoginSubmit.addEventListener('click', async (ev) => {
          ev.preventDefault();
          const u = (dossierLoginUser?.value || '').trim();
          const p = dossierLoginPass?.value || '';
          if (!u || !p) {
            if (dossierLoginError) { dossierLoginError.textContent = 'Remplis les deux champs.'; dossierLoginError.style.display = 'block'; }
            return;
          }
          dossierLoginSubmit.disabled = true;
          dossierLoginSubmit.textContent = 'Connexion...';
          const res = await authenticateInline(u, p);
          dossierLoginSubmit.disabled = false;
          dossierLoginSubmit.textContent = 'Se connecter';
          if (!res.ok) {
            if (dossierLoginError) { dossierLoginError.textContent = res.message || 'Erreur'; dossierLoginError.style.display = 'block'; }
            return;
          }
          currentUser = res.user;
          if (dossierLogin) dossierLogin.style.display = 'none';
          if (dossierListWrapper) dossierListWrapper.style.display = 'block';
          showToast(`Connecté · ${currentUser.user}`, { type: 'success', duration: 2200 });
          await loadQuotaData();
        });
      }
      if (dossierLoginCancel) {
        dossierLoginCancel.addEventListener('click', (e) => {
          e.preventDefault();
          // go back to Rajout
          activateTab('rajout');
        });
      }

      // === TAB HANDLING ===
      const tabButtons = document.querySelectorAll('.quota-tab-btn');
    
      function activateTab(name) {
        // Mettre à jour les boutons actifs
        tabButtons.forEach(b => b.classList.toggle('active', b.dataset.tab === name));
        // Mettre à jour les contenus
        document.querySelectorAll('.quota-tab-content').forEach(c => {
          c.classList.toggle('active', c.id === 'tab-' + name);
        });

        // Appliquer le thème global
        const modalContent = document.querySelector('.quota-modal-content');
        if (modalContent) {
          modalContent.classList.remove('rajout-theme', 'dossier-theme');
          if (name === 'rajout') {
            modalContent.classList.add('rajout-theme');
          } else if (name === 'dossier') {
            modalContent.classList.add('dossier-theme');
          }
        }
      }
    
      // Écouteurs sur les onglets
      tabButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const tab = btn.dataset.tab;
          activateTab(tab);
    
          if (tab === 'dossier') {
            if (dossierLogin) {
              if (!currentUser) {
                dossierLogin.style.display = 'block';
                if (dossierListWrapper) dossierListWrapper.style.display = 'none';
                if (dossierLoginError) dossierLoginError.style.display = 'none';
                dossierLoginUser?.focus();
              } else {
                dossierLogin.style.display = 'none';
                if (dossierListWrapper) dossierListWrapper.style.display = 'block';
                loadQuotaData();
              }
            } else {
              showGlobalLoginModal();
            }
          } else {
            setTimeout(() => document.getElementById('quota-nom')?.focus(), 60);
          }
        });
      });

      function showGlobalLoginModal(message) {
        const modal = document.getElementById('login-modal');
        if (!modal) { injectGlobalLoginIfNeeded(); }
        const mm = document.getElementById('login-modal');
        if (!mm) return;
        mm.style.display = 'flex';
        if (message) {
          const err = document.getElementById('login-error');
          if (err) { err.textContent = message; err.style.display = 'block'; }
        }
      }

      // === OPEN / CLOSE QUOTA MODAL ===
      secretBtn?.addEventListener('click', () => {
        if (!quotaModal) return;
        quotaModal.style.display = 'flex';
        quotaModal.setAttribute('aria-hidden', 'false');
        
        // Réinitialiser la hauteur pour permettre l'animation
        const modalContent = document.querySelector('.quota-modal-content');
        if (modalContent) modalContent.style.height = 'auto';

        activateTab('rajout'); // déclenche l’animation vers Rajout

        if (dossierLogin) dossierLogin.style.display = 'none';
        if (dossierListWrapper) dossierListWrapper.style.display = 'none';
      });

      closeQuota?.addEventListener('click', () => {
        if (!quotaModal) return;
        quotaModal.style.display = 'none';
        quotaModal.setAttribute('aria-hidden', 'true');
      });

      // close modal on outside click
      quotaModal?.addEventListener('click', (e) => {
        if (e.target === quotaModal) {
          quotaModal.style.display = 'none';
          quotaModal.setAttribute('aria-hidden','true');
        }
      });

      // === GESTION DU FICHIER + PREVIEW ===
      const imageUpload = document.getElementById('quota-image-upload');
      const preview = document.getElementById('image-preview');
      const previewImg = document.getElementById('preview-img');

      if (imageUpload) {
        imageUpload.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (ev) => {
              previewImg.src = ev.target.result;
              preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
          } else {
            preview.style.display = 'none';
          }
        });
      }

      // === ENVOI DU RAJOUT AVEC IMAGE VIA IMGBB + WEBHOOK ===
      quotaForm?.addEventListener('submit', async (e) => {
        e.preventDefault();

        const nom = document.getElementById('quota-nom')?.value.trim();
        const categorie = document.getElementById('quota-categorie')?.value;
        const quotaRaw = document.getElementById('quota-valeur')?.value?.trim();
        const fileInput = document.getElementById('quota-image-upload');
        const file = fileInput?.files[0];

        if (!nom || !categorie || !quotaRaw) {
          showToast('Veuillez remplir tous les champs obligatoires.', { type: 'info', duration: 2500 });
          return;
        }

        const quotaNum = Number(quotaRaw.replace(/\s/g, '').replace(',', '.'));
        if (isNaN(quotaNum)) {
          showToast('Quota invalide.', { type: 'info', duration: 2500 });
          return;
        }
        const quotaFormatted = `${Math.round(quotaNum).toLocaleString('fr-FR')} €`;

        // Générer timestamp FR
        const now = new Date();
        const options = { hour: '2-digit', minute: '2-digit', day: '2-digit', month: '2-digit', year: 'numeric' };
        const timestamp = now.toLocaleString('fr-FR', options).replace(/\sà\s/, ' à ');

        let imageUrl = '';

        // ✅ UPLOAD DE L'IMAGE SUR IMGBB (si fournie)
        if (file) {
          const maxSize = 8 * 1024 * 1024; // 8 Mo max
          if (file.size > maxSize) {
            showToast('⚠️ Image trop lourde (max 8 Mo).', { type: 'info', duration: 2500 });
            return;
          }

          const formData = new FormData();
          formData.append('image', file);

          try {
            showToast('📤 Upload de la preuve...', { type: 'info', duration: 1500 });
            const imgbbRes = await fetch('https://api.imgbb.com/1/upload?key=7b7b6e5d7d3e3f2c3c4d5e6f7g8h9i0j', {
              method: 'POST',
              body: formData
            });

            const imgbbJson = await imgbbRes.json();
            if (!imgbbJson.success) {
              throw new Error(imgbbJson.error?.message || 'Échec upload ImgBB');
            }
            imageUrl = imgbbJson.data.url;
          } catch (err) {
            console.error('Erreur upload ImgBB:', err);
            showToast('❌ Échec upload image. Rajout annulé.', { type: 'info', duration: 3000 });
            return;
          }
        }

        // ✅ PRÉPARER L'EMBED DISCORD
        const embed = {
          title: `🆕 Nouveau rajout — ${categorie}`,
          color: 0xff3333,
          fields: [
            { name: '👤 Membre', value: nom, inline: true },
            { name: '💶 Quota', value: quotaFormatted, inline: true },
            { name: '🕒 Horodatage', value: timestamp, inline: false }
          ],
          footer: { text: 'Onyx Wolves • Rajout Automatique' },
          timestamp: new Date().toISOString()
        };

        if (imageUrl) {
          embed.image = { url: imageUrl };
        }

        const webhookUrl = 'https://discord.com/api/webhooks/1448356158313336973/88xTqKQZgOEamR-xYAHVVLRzmbLiqGlellVZaosWtu1ZlDFC1kDVe6_J8UyFUZO99yQ2';

        try {
          const response = await fetch(webhookUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] })
          });

          if (response.ok) {
            showToast('✅ Rajout envoyé sur Discord !', { type: 'success', duration: 2500 });
            quotaForm.reset();
            preview.style.display = 'none';
            document.querySelectorAll('.quota-cat-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('quota-categorie').value = '';
          } else {
            const errText = await response.text();
            console.error('Erreur webhook:', errText);
            showToast('❌ Échec envoi Discord.', { type: 'info', duration: 3000 });
          }
        } catch (err) {
          console.error('Erreur réseau webhook:', err);
          showToast('Erreur réseau – impossible d’envoyer.', { type: 'info', duration: 3000 });
        }
      });
      
      // === LOAD QUOTA DATA (fills quota-list-container) ===
      async function loadQuotaData() {
        if (!supabase) { showErrorModal('Erreur', 'Supabase indisponible.'); if (quotaListContainer) quotaListContainer.innerHTML = '<p style="text-align:center;color:#f66;">Erreur</p>'; return; }
        if (!currentUser) { if (quotaListContainer) quotaListContainer.innerHTML = '<p style="text-align:center;color:#888;">Veuillez vous connecter.</p>'; return; }
        if (quotaListContainer) quotaListContainer.innerHTML = '<p style="text-align:center;color:#aaa;">Chargement...</p>';
        try {
          const { data, error } = await supabase.from('Quota').select('*').order('id', { ascending: false });
          if (error) { console.error('loadQuotaData error', error); if (quotaListContainer) quotaListContainer.innerHTML = `<p style="text-align:center;color:#f66;">${error.message}</p>`; return; }
          if (!data || data.length === 0) { if (quotaListContainer) quotaListContainer.innerHTML = '<p style="text-align:center;color:#888;">Aucun quota enregistré.</p>'; return; }
          // render simple dropdown style
          quotaListContainer.innerHTML = '';
          data.forEach(q => {
            const el = document.createElement('div');
            el.className = 'quota-entry';
            const quotaText = q.quota ?? '';
            const tempsText = q.temps ?? '';
            el.innerHTML = `<strong>${q.categorie || ''}</strong> — ${q.nom || ''}<br><small>Quota : ${quotaText} • ${tempsText}</small>`;
            quotaListContainer.appendChild(el);
          });
        } catch (err) {
          console.error('Exception loadQuotaData', err);
          showErrorModal('Erreur réseau', 'Impossible de charger le dossier (voir console).');
          if (quotaListContainer) quotaListContainer.innerHTML = '<p style="text-align:center;color:#f66;">Erreur réseau</p>';
        }
      }

      // If page pre-opens quota modal via other buttons (like mathieu-driven-btn), ensure Rajout default
      document.getElementById('mathieu-driven-btn')?.addEventListener('click', () => {
        if (!quotaModal) return;
        quotaModal.style.display = 'flex';
        activateTab('rajout');
        if (currentUser) loadQuotaData();
      });

      // End of DOMContentLoaded
    });
  </script>
</body>
</html>
